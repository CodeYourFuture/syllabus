"use strict";(self.webpackChunkcodeyourfuture_syllabus=self.webpackChunkcodeyourfuture_syllabus||[]).push([[2734],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return c}});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},m=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=d(a),c=o,h=u["".concat(s,".").concat(c)]||u[c]||p[c]||i;return a?n.createElement(h,r(r({ref:t},m),{},{components:a})):n.createElement(h,r({ref:t},m))}));function c(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,r=new Array(i);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var d=2;d<i;d++)r[d]=a[d];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},57723:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(67294);function o(e){var t="https://docs.google.com/forms/d/e/1FAIpQLScq8Zgr0pz7aMDj0D768eCpW798XgtDsKfpA6BquqK5Hdtj4A/viewform?embedded=true&entry.1672476057="+e.module.replace(" ","+")+"&entry.74981796="+e.week.replace(" ","+");return n.createElement("div",{className:"feedback"},n.createElement("div",{className:"feedback__wrapper"},n.createElement("iframe",{src:t,width:"640",height:"640",frameborder:"0",marginheight:"0",marginwidth:"0"},"Loading\u2026"),n.createElement("center",null,n.createElement("p",null,"Not loading? Form can be found"," ",n.createElement("a",{target:"_blank",href:t},"here"),". Click"," ",n.createElement("a",{target:"_blank",href:"https://docs.google.com/forms/d/1F2mB10japkHAPb3H-9Q4YrYH0i61GoMG1tk-P4ZT808/edit"},"here")," ","to get edit access."))))}},91106:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return d},metadata:function(){return m},assets:function(){return p},toc:function(){return u},default:function(){return h}});var n=a(87462),o=a(63366),i=(a(67294),a(3905)),r=a(57723),l=["components"],s={id:"lesson",title:"Node - 2",sidebar_label:"Lesson"},d=void 0,m={unversionedId:"node/week-2/lesson",id:"node/week-2/lesson",title:"Node - 2",description:"Learning Objectives",source:"@site/docs/node/week-2/lesson.md",sourceDirName:"node/week-2",slug:"/node/week-2/lesson",permalink:"/node/week-2/lesson",editUrl:"https://github.com/CodeYourFuture/Syllabus-V2/edit/master/docs/node/week-2/lesson.md",tags:[],version:"current",frontMatter:{id:"lesson",title:"Node - 2",sidebar_label:"Lesson"},sidebar:"Node",previous:{title:"Instructor Notes",permalink:"/node/week-1/instructors"},next:{title:"Coursework",permalink:"/node/week-2/homework"}},p={},u=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"1) Presentations",id:"1-presentations",level:2},{value:"2) CRUD Continued",id:"2-crud-continued",level:2},{value:"3) Workshop",id:"3-workshop",level:2},{value:"Workshop Objective",id:"workshop-objective",level:3},{value:"3.1) Get All Albums",id:"31-get-all-albums",level:3},{value:"3.2) Get Album by ID",id:"32-get-album-by-id",level:3},{value:"3.2.1) Live Coding",id:"321-live-coding",level:3},{value:"3.2.2) Workshop",id:"322-workshop",level:3},{value:"3.3) Install Nodemon",id:"33-install-nodemon",level:3},{value:"3.4) Add a New Album",id:"34-add-a-new-album",level:3},{value:"3.4.1) Live Coding",id:"341-live-coding",level:4},{value:"3.4.2) Workshop",id:"342-workshop",level:4},{value:"3.5) Delete an album",id:"35-delete-an-album",level:3},{value:"3.5.1) Delete Exercise",id:"351-delete-exercise",level:4},{value:"3.5.2) Workshop",id:"352-workshop",level:4},{value:"Feedback",id:"feedback",level:2}],c={toc:u};function h(e){var t=e.components,a=(0,o.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"learning-objectives"},"Learning Objectives"),(0,i.kt)("p",null,"By the end of this lesson trainees should be able to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Define what each part of CRUD is and what it does"),(0,i.kt)("li",{parentName:"ul"},"Process a GET request using Express and Node to retrieve data from memory"),(0,i.kt)("li",{parentName:"ul"},"Process a POST request using Express and Node and store data in memory"),(0,i.kt)("li",{parentName:"ul"},"Process a DELETE request using Express and Node to remove data from memory"),(0,i.kt)("li",{parentName:"ul"},"Install a third party library using ",(0,i.kt)("inlineCode",{parentName:"li"},"npm"))),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"1-presentations"},"1) Presentations"),(0,i.kt)("p",null,"As part of last weeks homework we asked you to prepare a very short presentation on what you learnt last week."),(0,i.kt)("p",null,"Split into groups of 2-4 people and present what you have learnt. Remember, your whole presentation should be no more than 120 seconds!"),(0,i.kt)("h2",{id:"2-crud-continued"},"2) CRUD Continued"),(0,i.kt)("p",null,"So what will we build? we will build a ",(0,i.kt)("strong",{parentName:"p"},"CRUD")," API. CRUD stands for Create, Retrieve, Update, Delete. If you think about it, this is what most applications do:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'Create some "resources"'),(0,i.kt)("li",{parentName:"ul"},"Retrieve them (GET them)"),(0,i.kt)("li",{parentName:"ul"},"Update them"),(0,i.kt)("li",{parentName:"ul"},"Delete them")),(0,i.kt)("p",null,"Below are three in-class exercises which can be used to demonstrate parts of the API workshop below."),(0,i.kt)("h2",{id:"3-workshop"},"3) Workshop"),(0,i.kt)("p",null,"You can use this ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/nbogie/express-notes/blob/master/express-cheatsheet.md"},"Express Cheatsheet")," to help you."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"API")," stands for Application Programming Interface."),(0,i.kt)("p",null,"Read this description of what an API from ",(0,i.kt)("a",{parentName:"p",href:"https://www.howtogeek.com/343877/what-is-an-api/"},"How To Geek"),"."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Think of an API like a menu in a restaurant. The menu provides a list of dishes you can order, along with a description of each dish. When you specify what menu items you want, the restaurant\u2019s kitchen does the work and provides you with some finished dishes. You don\u2019t know exactly how the restaurant prepares that food, and you don\u2019t really need to.\nSimilarly, an API lists a bunch of operations that developers can use, along with a description of what they do. The developer doesn\u2019t necessarily need to know how, for example, an operating system builds and presents a \u201cSave As\u201d dialog box. They just need to know that it\u2019s available for use in their app.")),(0,i.kt)("p",null,"An API does not have to be web-based. But in our work, since we are doing web development, we will work only with web based APIs, so you might as well hear the word ",(0,i.kt)("strong",{parentName:"p"},"Web Service"),", and we will communicate with those services using the protocol for Web: ",(0,i.kt)("strong",{parentName:"p"},"HTTP"),"."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Checkpoint")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Recap what we know about HTTP before continuing."))),(0,i.kt)("h3",{id:"workshop-objective"},"Workshop Objective"),(0,i.kt)("p",null,"Our ",(0,i.kt)("strong",{parentName:"p"},"API")," will manage Beyonc\xe9 albums:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create a new album,"),(0,i.kt)("li",{parentName:"ul"},"Retrieve a list of albums or a single album,"),(0,i.kt)("li",{parentName:"ul"},"Update an existing album's information"),(0,i.kt)("li",{parentName:"ul"},"Delete an album")),(0,i.kt)("p",null,"We will build these endpoints:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"GET /albums")," should return all the albums"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"GET /albums/:albumId")," should return a single album (that matches the passed albumId)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"POST /albums")," should save a new album"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"PUT /albums/:albumId")," should update the album (that matches the passed albumId)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"DELETE /albums/:albumId")," should delete the album (that matches the passed albumId)")),(0,i.kt)("h3",{id:"31-get-all-albums"},"3.1) Get All Albums"),(0,i.kt)("p",null,"To get started, let's setup our server so that we can retrieve all of the albums at once"),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Exercise")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("ol",{parentName:"div"},(0,i.kt)("li",{parentName:"ol"},"In ",(0,i.kt)("inlineCode",{parentName:"li"},"server.js")," Add the endpoint for ",(0,i.kt)("inlineCode",{parentName:"li"},"GET /albums"),".")),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const albumsData = [\n  {\n    albumId: "10",\n    artistName: "Beyonc\xe9",\n    collectionName: "Lemonade",\n    artworkUrl100:\n      "http://is1.mzstatic.com/image/thumb/Music20/v4/23/c1/9e/23c19e53-783f-ae47-7212-03cc9998bd84/source/100x100bb.jpg",\n    releaseDate: "2016-04-25T07:00:00Z",\n    primaryGenreName: "Pop",\n    url: "https://www.youtube.com/embed/PeonBmeFR8o?rel=0&amp;controls=0&amp;showinfo=0",\n  },\n  {\n    albumId: "11",\n    artistName: "Beyonc\xe9",\n    collectionName: "Dangerously In Love",\n    artworkUrl100:\n      "http://is1.mzstatic.com/image/thumb/Music/v4/18/93/6d/18936d85-8f6b-7597-87ef-62c4c5211298/source/100x100bb.jpg",\n    releaseDate: "2003-06-24T07:00:00Z",\n    primaryGenreName: "Pop",\n    url: "https://www.youtube.com/embed/ViwtNLUqkMY?rel=0&amp;controls=0&amp;showinfo=0",\n  },\n];\n\napp.get("/albums", function (req, res) {\n  res.send(albumsData);\n});\n')),(0,i.kt)("ol",{parentName:"div",start:2},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Test the endpoint with Postman. ",(0,i.kt)("inlineCode",{parentName:"p"},"GET /albums")," should return a JSON reply with the array we specified.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add another item to the array and test that the ",(0,i.kt)("inlineCode",{parentName:"p"},"GET /albums")," returns three items. (Remember you need to close the server ",(0,i.kt)("inlineCode",{parentName:"p"},"ctrl+c")," and run it again ",(0,i.kt)("inlineCode",{parentName:"p"},"node server.js"),")"))))),(0,i.kt)("h3",{id:"32-get-album-by-id"},"3.2) Get Album by ID"),(0,i.kt)("h3",{id:"321-live-coding"},"3.2.1) Live Coding"),(0,i.kt)("p",null,"This is an Teacher led exercise which can be used to show how we might retrieve an element by ID using a GET request."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Teacher Led Live Coding")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("h4",{parentName:"div",id:"objective"},"Objective"),(0,i.kt)("p",{parentName:"div"},"Change a quote API server to allow ",(0,i.kt)("inlineCode",{parentName:"p"},"GET"),"ting a quote according to the given ID."),(0,i.kt)("p",{parentName:"div"},"The id should be given in the URL structure like this:"),(0,i.kt)("blockquote",{parentName:"div"},(0,i.kt)("p",{parentName:"blockquote"},"/quotes/242342")),(0,i.kt)("p",{parentName:"div"},"You should use the starting project: ",(0,i.kt)("a",{parentName:"p",href:"https://glitch.com/~cyf-quotes-ids-start"},"cyf-quotes-id-start"),". This is because this project has quotes with IDs."),(0,i.kt)("p",{parentName:"div"},"When you remix the starting project, immediately rename it as your own."))),(0,i.kt)("h3",{id:"322-workshop"},"3.2.2) Workshop"),(0,i.kt)("p",null,"Sometimes, we do not want to ",(0,i.kt)("em",{parentName:"p"},"list")," all the information in one request, maybe we only want to get the information related to a single album. Imagine if we have a page to display the details of one album, we could call the server and get all albums then filter the one we need ",(0,i.kt)("em",{parentName:"p"},"client-side"),", but would it not be more effective to tell the server to just return the one album we are interested in?"),(0,i.kt)("p",null,"Let us add a new endpoint to return only a single album ",(0,i.kt)("inlineCode",{parentName:"p"},"GET /albums/:albumId"),". In this case, ",(0,i.kt)("em",{parentName:"p"},"albumId")," will tell us what album we can return so the call will be something like ",(0,i.kt)("inlineCode",{parentName:"p"},"GET /albums/242342")," and that will return the album with that has ",(0,i.kt)("em",{parentName:"p"},"albumId")," 242342."),(0,i.kt)("p",null,"This endpoint has something different. The endpoint ",(0,i.kt)("inlineCode",{parentName:"p"},"/albums/:albumId")," has a ",(0,i.kt)("em",{parentName:"p"},"dynamic")," part, the ",(0,i.kt)("em",{parentName:"p"},"albumId")," will vary depending on what the client send. If we call ",(0,i.kt)("inlineCode",{parentName:"p"},"/albums/424252")," then albumId is 424252, if we call ",(0,i.kt)("inlineCode",{parentName:"p"},"/albums/242342")," then we will return the album with albumId 242342 and so on."),(0,i.kt)("p",null,"How can we achieve that using ",(0,i.kt)("inlineCode",{parentName:"p"},"express")," - ",(0,i.kt)("inlineCode",{parentName:"p"},"req.params")," will have the value of"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'app.get("/albums/:albumId", function (req, res) {\n  // req.params.albumId will match the value in the url after /albums/\n  console.log(req.params.albumId);\n  // now we can use the value for req.params.albumId to find the album requested\n  // how do we "find" something in an array\n\n  // finish the code yourself - it should end with res.send(album) where album is the single album you found  based on the id\n});\n')),(0,i.kt)("h3",{id:"33-install-nodemon"},"3.3) Install Nodemon"),(0,i.kt)("p",null,"It is a bit annoying that we have to ",(0,i.kt)("em",{parentName:"p"},"kill")," and ",(0,i.kt)("em",{parentName:"p"},"restart")," our server every time we want to test our changes. There is a handy ",(0,i.kt)("strong",{parentName:"p"},"npm package")," that can help us with that task."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"npm install --save-dev nodemon")),(0,i.kt)("p",null,"Make sure the package is added to your ",(0,i.kt)("em",{parentName:"p"},"package.json"),", add this line to the script:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'"scripts": {\n  "start": "node server.js",\n  "dev": "nodemon server.js"\n},\n')),(0,i.kt)("p",null,"now from your terminal, use the command ",(0,i.kt)("inlineCode",{parentName:"p"},"npm run dev")," and that will run the ",(0,i.kt)("em",{parentName:"p"},"server")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"nodemon")," which is a package that makes the server listen to code changes and automatically restart."),(0,i.kt)("h3",{id:"34-add-a-new-album"},"3.4) Add a New Album"),(0,i.kt)("h4",{id:"341-live-coding"},"3.4.1) Live Coding"),(0,i.kt)("p",null,"This is an Teacher led exercise which can be used to show how we might add an element using an API"),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Teacher Led Live Coding")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("h4",{parentName:"div",id:"objective-1"},"Objective"),(0,i.kt)("p",{parentName:"div"},"Change a quote API server to allow POSTs of new quotes."),(0,i.kt)("p",{parentName:"div"},"The new quotes should be added to your quotes list, which is an array in memory."),(0,i.kt)("p",{parentName:"div"},"You can assume the POSTed quotes are all in the correct JSON format."),(0,i.kt)("p",{parentName:"div"},"The route should use the HTTP method POST and should use the URL:"),(0,i.kt)("blockquote",{parentName:"div"},(0,i.kt)("p",{parentName:"blockquote"},"/quotes")),(0,i.kt)("p",{parentName:"div"},"You should use the starting project: ",(0,i.kt)("a",{parentName:"p",href:"https://glitch.com/~cyf-quotes-post-start"},"cyf-quotes-post-start"),", NOT your own existing quote server. This is because our project has an HTML form for creating new quotes."),(0,i.kt)("p",{parentName:"div"},"When you remix our starting project, immediately rename it."),(0,i.kt)("p",{parentName:"div"},"Then you can visit / and submit the form there, when you are ready to try to submit new quotes!"))),(0,i.kt)("h4",{id:"342-workshop"},"3.4.2) Workshop"),(0,i.kt)("p",null,"Our analogy with the Restaurant menu is somewhat incomplete."),(0,i.kt)("p",null,"In a restaurant, we only GET items from the menu. In the world of APIs, we also have the possibility to create items, we can provide ",(0,i.kt)("em",{parentName:"p"},"ingredients")," to create a new dish."),(0,i.kt)("p",null,"In this case, we provide some data (a payload) and we use a different verb ",(0,i.kt)("strong",{parentName:"p"},"POST")," (Create) as opposed to GET."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"POST /albums")," should save a new album and return ",(0,i.kt)("inlineCode",{parentName:"p"},"200")," with JSON ",(0,i.kt)("inlineCode",{parentName:"p"},"{ success: true }")," to the user."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'// notice .post (not .get)\napp.post("/albums", function (req, res) {\n  console.log("POST /albums route");\n});\n')),(0,i.kt)("p",null,"Let's start by testing using Postman. Do a ",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," request to the endpoint and make sure it prints the console.log message we have added."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"In Postman, change the request ",(0,i.kt)("inlineCode",{parentName:"p"},"method")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," instead of ",(0,i.kt)("inlineCode",{parentName:"p"},"GET")," and test our endpoint. It should log the message to the terminal but the request will hang because we did not end it, i.e. we did not say ",(0,i.kt)("inlineCode",{parentName:"p"},"res.send(something)")))),(0,i.kt)("p",null,"So what format does the client send the data with? It is up to us, but since we already are familiar with ",(0,i.kt)("inlineCode",{parentName:"p"},"json"),", let us use it."),(0,i.kt)("p",null,"In order for our ",(0,i.kt)("em",{parentName:"p"},"server-side")," to receive and use the data sent by the client, we will need to install and use a ",(0,i.kt)("strong",{parentName:"p"},"middleware"),"."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Middleware: We will cover middleware in more details in the next class. For now, imagine pieces of code that process a request and pass it to the next middleware until one of them returns a response (with ",(0,i.kt)("inlineCode",{parentName:"p"},"res.send")," for example).")),(0,i.kt)("p",null,"The JSON middleware makes it easy for our route handlers to read JSON data from the request. If the ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type")," request header indicates that the request body contains JSON data then the middleware calls ",(0,i.kt)("inlineCode",{parentName:"p"},"JSON.parse")," to convert the request body into a JavaScript data structure."),(0,i.kt)("p",null,"To register the JSON middleware, add the following to the server code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"app.use(express.json()); // before our routes definition\n")),(0,i.kt)("p",null,"Now we will receive the data as ",(0,i.kt)("inlineCode",{parentName:"p"},"req.body"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'app.post("/albums", function (req, res) {\n  console.log("POST /albums route");\n  console.log(req.body);\n});\n')),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Exercise")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Use Postman to ",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," this data to ",(0,i.kt)("inlineCode",{parentName:"p"},"/albums")," endpoint."),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "albumId": "13",\n  "artistName": "Beyonc\xe9",\n  "collectionName": "B\'Day (Deluxe Edition)",\n  "artworkUrl100": "http://is5.mzstatic.com/image/thumb/Music/v4/6c/fc/6a/6cfc6a13-0633-f96b-9d72-cf56774beb4b/source/100x100bb.jpg",\n  "releaseDate": "2007-05-29T07:00:00Z",\n  "primaryGenreName": "Pop",\n  "url": "https://www.youtube.com/embed/RQ9BWndKEgs?rel=0&amp;controls=0&amp;showinfo=0"\n}\n')))),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Exercise")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Finish the code for the route ",(0,i.kt)("inlineCode",{parentName:"p"},"POST /albums")," to add the album data to the albums list (how to amend to an array?)"))),(0,i.kt)("h3",{id:"35-delete-an-album"},"3.5) Delete an album"),(0,i.kt)("h4",{id:"351-delete-exercise"},"3.5.1) Delete Exercise"),(0,i.kt)("p",null,"This is an Teacher led exercise which can be used to show how we might remove an element using an API"),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Teacher Led Live Coding")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("h4",{parentName:"div",id:"objective-2"},"Objective"),(0,i.kt)("p",{parentName:"div"},"Change a quote API server to allow updating a quote according to the given ID."),(0,i.kt)("p",{parentName:"div"},"The id should be given in the URL structure like this:"),(0,i.kt)("blockquote",{parentName:"div"},(0,i.kt)("p",{parentName:"blockquote"},"/quotes/2")),(0,i.kt)("p",{parentName:"div"},"You should use the ",(0,i.kt)("inlineCode",{parentName:"p"},"delete")," HTTP method"),(0,i.kt)("p",{parentName:"div"},"You should use this starting project: ",(0,i.kt)("a",{parentName:"p",href:"https://glitch.com/~cyf-quotes-id-start"},"cyf-quotes-id-start"),", NOT your own existing quote server. This is because this project has quotes with IDs."),(0,i.kt)("p",{parentName:"div"},"When you remix the starting project, immediately rename it as your own."))),(0,i.kt)("h4",{id:"352-workshop"},"3.5.2) Workshop"),(0,i.kt)("p",null,"Lets look back at our original objectives."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("inlineCode",{parentName:"p"},"DELETE /albums/:albumId")," should delete the album (that matches the passed albumId)")),(0,i.kt)("p",null,"This means that ",(0,i.kt)("inlineCode",{parentName:"p"},"DELETE /albums/2")," should delete an album with the id ",(0,i.kt)("inlineCode",{parentName:"p"},"2")," and return ",(0,i.kt)("inlineCode",{parentName:"p"},"200")," with JSON ",(0,i.kt)("inlineCode",{parentName:"p"},"{ success: true }")," to the user."),(0,i.kt)("p",null,"The code will look like this"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'// notice .delete\napp.delete("/albums/:albumID", function (req, res) {\n  console.log("DELETE /albums route");\n});\n')),(0,i.kt)("p",null,"Can you work out how to remove an album using this code?"),(0,i.kt)("h2",{id:"feedback"},"Feedback"),(0,i.kt)("p",null,"Please spend two minutes reviewing this lesson to help us improve it for the future. This feedback will be shared with volunteers."),(0,i.kt)(r.Z,{module:"Node",week:"Week 2",mdxType:"Feedback"}))}h.isMDXComponent=!0}}]);